<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Tom Linl&#39;s Blog</title>
  
  <subtitle>o(*￣▽￣*)ブ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-04-07T06:14:12.763Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Tom Linl</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Vue+tp5简单列表操作</title>
    <link href="http://yoursite.com/2018/03/06/vtpro/"/>
    <id>http://yoursite.com/2018/03/06/vtpro/</id>
    <published>2018-03-06T15:58:36.000Z</published>
    <updated>2018-04-07T06:14:12.763Z</updated>
    
    <content type="html"><![CDATA[<p>前段时间，初次使用前端框架Vue和ThinkPHP5.1，于是就简单结合起来，用Vue+axios发送请求，TP5处理接口数据。<br>这里Vue、axios和TP5等等的安装就不多说了，按照官方文档来就ok了。<br><a id="more"></a><br>Vue部分，在main.js中引入axios,qs来帮助处理数据，接口请求的时候会遇到跨域问题<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import axios from 'axios'</span><br><span class="line">import Qs from 'qs'</span><br><span class="line">Vue.prototype.$axios = axios;</span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">var axios_instance = axios.create(&#123;</span><br><span class="line">transformRequest: [function (data) &#123;</span><br><span class="line">data = Qs.stringify(data);</span><br><span class="line"><span class="keyword">return</span> data;</span><br><span class="line">&#125;],</span><br><span class="line"><span class="comment">//Post请求传递参数时，需要在请求头加上item.ContentType = "application/x-www-form-urlencoded";</span></span><br><span class="line">headers:&#123;'Content-Type':'application/x-www-form-urlencoded'&#125;</span><br><span class="line">&#125;)</span><br><span class="line">Vue.prototype.$axios = axios_instance;</span><br></pre></td></tr></table></figure></p><p>PHP部分后端响应头进行设置<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 指定允许其他域名访问</span></span><br><span class="line">header(<span class="string">"Access-Control-Allow-Origin:*"</span>);</span><br><span class="line"><span class="comment">// 响应类型</span></span><br><span class="line">header(<span class="string">"Access-Control-Allow-Methods:GET, POST, PATCH, PUT, DELETE"</span>);</span><br><span class="line"><span class="comment">// 响应头设置</span></span><br><span class="line">header(<span class="string">"Access-Control-Allow-Headers:x-requested-with,content-type"</span>);</span><br></pre></td></tr></table></figure></p><p>解决了跨域问题后，接下来就能通过接口请求和数据处理了。</p><p>在Vue的/config/dev.env.js 设置 API_HOST<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">'use strict'</span><br><span class="line">const merge = require('webpack-merge')</span><br><span class="line">const prodEnv = require('./prod.env')</span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span>.exports = merge(prodEnv, &#123;</span><br><span class="line">NODE_ENV: '"development"',</span><br><span class="line">API_HOST:'"http://127.0.0.1/tp5/"'</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>下面是一个简单的列表，包含简单的增删改查，查看单条数据等功能<br><img src="/2018/03/06/vtpro/list.png"><br>列表部分代码<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">template</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span>="<span class="title">list</span>-<span class="title">table</span>"&gt;</span></span><br><span class="line"><span class="class">        &lt;h1&gt;<span class="title">TODO</span>-<span class="title">LIST</span>&lt;/h1&gt;</span></span><br><span class="line"><span class="class">        &lt;form&gt;</span></span><br><span class="line"><span class="class">            姓名：&lt;input type="text" v-model="nickname"/&gt; &#123;</span>&#123;nickname&#125;&#125;</span><br><span class="line">            &lt;br/&gt;</span><br><span class="line">            年龄：&lt;input type=<span class="string">"text"</span> v-model=<span class="string">"age"</span>/&gt;  &#123;&#123;age&#125;&#125;</span><br><span class="line">            &lt;br/&gt;</span><br><span class="line">            &lt;span style=<span class="string">"color:red"</span> v-<span class="keyword">if</span>=<span class="string">"!isAge"</span>&gt;年龄必须是数字&lt;/span&gt;</span><br><span class="line">            &lt;br/&gt;</span><br><span class="line">            &lt;br/&gt;</span><br><span class="line">            &lt;button type=<span class="string">"button"</span> @click=<span class="string">"addList"</span>&gt;添加&lt;/button&gt;</span><br><span class="line">            &lt;button type=<span class="string">"button"</span> @click=<span class="string">"init()"</span>&gt;重置&lt;/button&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &lt;br/&gt;</span><br><span class="line">        &lt;table border=<span class="string">"1"</span> cellspacing=<span class="string">"0"</span>&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">                &lt;th&gt;序号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;年龄&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tr v-<span class="keyword">for</span>=<span class="string">"(data,index) in  list"</span>&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;index+<span class="number">1</span>&#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;data.nickname&#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;data.age&#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                    &lt;button @click=<span class="string">"detail(index)"</span>&gt;查看详情&lt;/button&gt;</span><br><span class="line">                    &lt;button @click=<span class="string">"delList(index)"</span>&gt;删除&lt;/button&gt;</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td colspan=<span class="string">"2"</span> style=<span class="string">"text-align: center"</span>&gt;总年龄：&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;sumAge&#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;button @click=<span class="string">"controlList"</span>&gt;清空/还原&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/<span class="keyword">template</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name:<span class="string">"TODOList"</span></span><br><span class="line">    data () &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="comment">//姓名</span></span><br><span class="line">            nickname:<span class="string">""</span>,</span><br><span class="line">            <span class="comment">//年龄</span></span><br><span class="line">            age:<span class="string">""</span>,</span><br><span class="line">            <span class="comment">//age是数字</span></span><br><span class="line">            isAge:<span class="literal">true</span>,</span><br><span class="line">            <span class="built_in">list</span>: [],</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created()&#123;</span><br><span class="line">        <span class="keyword">this</span>.getList()</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取列表数据</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    getList: function () &#123;</span><br><span class="line">        let $<span class="keyword">this</span> = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">this</span>.$axios.get(process.env.API_HOST)</span><br><span class="line">        .then(function(response)&#123;</span><br><span class="line">        $<span class="keyword">this</span>.<span class="built_in">list</span> = response.data;</span><br><span class="line">        console.<span class="built_in">log</span>(response.data);</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="keyword">catch</span>(function (error) &#123;</span><br><span class="line">        console.<span class="built_in">log</span>(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 新增列表数据</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    addList:function()&#123;</span><br><span class="line">        let $<span class="keyword">this</span> = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.isAge)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>($<span class="keyword">this</span>.nickname &amp;&amp; $<span class="keyword">this</span>.age)&#123;</span><br><span class="line">            $this.$axios.get(process.env.API_HOST + 'index/index/addList',&#123;</span><br><span class="line">                params: &#123;</span><br><span class="line">                    nickname: $<span class="keyword">this</span>.nickname,</span><br><span class="line">                    age: $<span class="keyword">this</span>.age</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).then(function (response) &#123;</span><br><span class="line">                console.<span class="built_in">log</span>(response.data);</span><br><span class="line">                $<span class="keyword">this</span>.<span class="built_in">list</span>.push(&#123;</span><br><span class="line">                    nickname:response.data.nickname,</span><br><span class="line">                    age:response.data.age</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;).<span class="keyword">catch</span>(function (error) &#123;</span><br><span class="line">                console.<span class="built_in">log</span>(error);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 删除列表数据</span></span><br><span class="line"><span class="comment">    * @param index  list键值</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    delList:function(index)&#123;</span><br><span class="line">        let $<span class="keyword">this</span> = <span class="keyword">this</span>;</span><br><span class="line">        if(confirm('确定要删除吗'))&#123;</span><br><span class="line">            <span class="keyword">if</span>($<span class="keyword">this</span>.<span class="built_in">list</span>[index] != undefined)&#123;</span><br><span class="line">                $this.$axios.post(process.env.API_HOST + 'index/index/delList',&#123;</span><br><span class="line">                    nickname: $<span class="keyword">this</span>.<span class="built_in">list</span>[index].nickname</span><br><span class="line">                    &#125;).then(function (response) &#123;</span><br><span class="line">                        if(response.data=='操作成功')&#123;</span><br><span class="line">                            $<span class="keyword">this</span>.<span class="built_in">list</span>.splice(index,<span class="number">1</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;).<span class="keyword">catch</span>(function (error) &#123;</span><br><span class="line">                    console.<span class="built_in">log</span>(error);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 清空或还原列表数据</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    controlList:function()&#123;</span><br><span class="line">        if(confirm('确定要执行此操作吗'))&#123;</span><br><span class="line">            this.$axios.post(process.env.API_HOST + 'index/index/controlList').then(response=&gt;&#123;</span><br><span class="line">                if(response.data=='')&#123;</span><br><span class="line">                    <span class="keyword">this</span>.<span class="built_in">list</span>.splice(<span class="number">0</span>,<span class="keyword">this</span>.<span class="built_in">list</span>.length);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">for</span> (var i in response.data) &#123;</span><br><span class="line">                        <span class="keyword">this</span>.<span class="built_in">list</span>.push(&#123;</span><br><span class="line">                        nickname:response.data[i].nickname,</span><br><span class="line">                        age:response.data[i].age</span><br><span class="line">                    &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).<span class="keyword">catch</span>(function (error) &#123;</span><br><span class="line">                console.<span class="built_in">log</span>(error);</span><br><span class="line">            &#125;);;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    detail:function(index)&#123;</span><br><span class="line">        this.$router.push(&#123;path:'/detail',query: &#123;nickname: this.list[index].nickname&#125;&#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 初始化输入</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    init:function()&#123;</span><br><span class="line">        <span class="keyword">this</span>.nickname = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">this</span>.age = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">this</span>.isAge = <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 检测数字</span></span><br><span class="line"><span class="comment">    * @param theObj       要检测的字符串</span></span><br><span class="line"><span class="comment">    * @returns &#123;boolean&#125;  是数字放回true  不是返回false</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    checkNumber:function(theObj) &#123;</span><br><span class="line">        var reg = /^[<span class="number">0</span><span class="number">-9</span>]+$/;</span><br><span class="line">        <span class="keyword">if</span>(reg.test(theObj))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed:&#123;</span><br><span class="line">        sumAge:function()&#123;</span><br><span class="line">            var ages = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (var i in <span class="keyword">this</span>.<span class="built_in">list</span>) &#123;</span><br><span class="line">                ages += Number(<span class="keyword">this</span>.<span class="built_in">list</span>[i].age);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ages;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch:&#123;</span><br><span class="line">        age:&#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">            * 监听age的变化</span></span><br><span class="line"><span class="comment">            * @param newValue</span></span><br><span class="line"><span class="comment">            * @param oldValue</span></span><br><span class="line"><span class="comment">            * @returns &#123;boolean&#125;</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            handler(newValue, oldValue)&#123;</span><br><span class="line">                <span class="keyword">if</span>(newValue == <span class="string">""</span>)&#123;</span><br><span class="line">                    <span class="keyword">this</span>.isAge = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                var res = <span class="keyword">this</span>.checkNumber(newValue);</span><br><span class="line">                <span class="keyword">if</span>(res)&#123;</span><br><span class="line">                    <span class="keyword">this</span>.isAge = <span class="literal">true</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">this</span>.isAge = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">    .<span class="built_in">list</span>-table&#123;</span><br><span class="line">        width: <span class="number">100</span>%;</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="built_in">list</span>-table table&#123;</span><br><span class="line">        margin: <span class="number">0</span> <span class="keyword">auto</span>;</span><br><span class="line">        width: <span class="number">500</span>px;</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="built_in">list</span>-table table th&#123;</span><br><span class="line">        font-size: <span class="number">28</span>px;</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="built_in">list</span>-table table td&#123;</span><br><span class="line">        padding: <span class="number">5</span>px <span class="number">0</span>;</span><br><span class="line">        font-size: <span class="number">20</span>px;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p><img src="/2018/03/06/vtpro/detail.png"><p>详情部分代码<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">template</span>&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>="<span class="title">list</span>-<span class="title">table</span>"&gt;</span></span><br><span class="line">    &lt;h1&gt;&#123;&#123;msg&#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;table border=<span class="string">"1"</span> cellspacing=<span class="string">"0"</span>&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">        &lt;th&gt;用户UID&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;年龄&lt;/th&gt;</span><br><span class="line">    &lt;/thead&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;uid&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;nickname&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;age&#125;&#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td colspan=<span class="string">"2"</span>&gt;信息介绍&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">            &lt;button type=<span class="string">"button"</span> @click=<span class="string">"OpenModal"</span>&gt;添加/编辑信息&lt;/button&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td colspan=<span class="string">"3"</span> v-<span class="keyword">if</span>=<span class="string">"info"</span>&gt;&#123;&#123;info&#125;&#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;router-link to=<span class="string">"/list"</span>&gt;返回&lt;/router-link&gt;</span><br><span class="line">        &lt;div class=<span class="string">"open-box"</span> v-<span class="keyword">if</span>=<span class="string">"OpenShow"</span>&gt;</span><br><span class="line">            &lt;div class=<span class="string">"open-box-content"</span>&gt;</span><br><span class="line">                &lt;h3&gt;编辑信息&lt;/h3&gt;</span><br><span class="line">                &lt;p&gt;请输入您的个人信息&lt;/p&gt;</span><br><span class="line">                &lt;textarea v-model=<span class="string">"info"</span>&gt;&#123;&#123;info&#125;&#125;&lt;/textarea&gt;</span><br><span class="line">                &lt;div class=<span class="string">"open-box-btn"</span>&gt;</span><br><span class="line">                    &lt;div class=<span class="string">"open-box-btn-left"</span>&gt;</span><br><span class="line">                        &lt;button @click=<span class="string">"addinfo"</span>&gt;保存&lt;/button&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=<span class="string">"open-box-btn-right"</span>&gt;</span><br><span class="line">                        &lt;button @click=<span class="string">"ColseModal"</span>&gt;关闭&lt;/button&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">         &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/<span class="keyword">template</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: 'Detail',</span><br><span class="line">    data () &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">        msg: '信息详情',</span><br><span class="line">        uid:'',</span><br><span class="line">        <span class="comment">//姓名</span></span><br><span class="line">        nickname:<span class="string">""</span>,</span><br><span class="line">        <span class="comment">//年龄</span></span><br><span class="line">        age:<span class="string">""</span>,</span><br><span class="line">        OpenShow: <span class="literal">false</span>,</span><br><span class="line">        info:<span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created()&#123;</span><br><span class="line">        <span class="keyword">this</span>.getinfo()</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取信息</span></span><br><span class="line"><span class="comment">    */</span>    </span><br><span class="line">    getinfo: function () &#123;</span><br><span class="line">        let $<span class="keyword">this</span> = <span class="keyword">this</span>;</span><br><span class="line">        this.$axios.get(process.env.API_HOST+'index/index/getInfo',&#123;</span><br><span class="line">        params:&#123;nickname:<span class="keyword">this</span>.$route.query.nickname&#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(function(response)&#123;</span><br><span class="line">        $<span class="keyword">this</span>.nickname = response.data.nickname</span><br><span class="line">        $<span class="keyword">this</span>.age = response.data.age</span><br><span class="line">        $<span class="keyword">this</span>.uid = response.data.uid</span><br><span class="line">        $<span class="keyword">this</span>.info = response.data.info</span><br><span class="line">        console.<span class="built_in">log</span>(response.data);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="keyword">catch</span>(function (error) &#123;</span><br><span class="line">        console.<span class="built_in">log</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 编辑信息</span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    addinfo: function()&#123;</span><br><span class="line">        this.$axios.post(process.env.API_HOST+'index/index/addInfo',&#123;</span><br><span class="line">        info:<span class="keyword">this</span>.info,</span><br><span class="line">        uid:<span class="keyword">this</span>.uid</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(response=&gt;&#123;</span><br><span class="line">        alert(response.data)</span><br><span class="line">        <span class="keyword">this</span>.OpenShow = !<span class="keyword">this</span>.OpenShow</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="keyword">catch</span>(function(error)&#123;</span><br><span class="line">        console.<span class="built_in">log</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    OpenModal() &#123;</span><br><span class="line">        <span class="keyword">this</span>.OpenShow = !<span class="keyword">this</span>.OpenShow</span><br><span class="line">    &#125;,</span><br><span class="line">    ColseModal() &#123;</span><br><span class="line">        <span class="keyword">this</span>.OpenShow = !<span class="keyword">this</span>.OpenShow</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.<span class="built_in">list</span>-table&#123;</span><br><span class="line">width: <span class="number">100</span>%;</span><br><span class="line">&#125;</span><br><span class="line">.<span class="built_in">list</span>-table table&#123;</span><br><span class="line">margin: <span class="number">0</span> <span class="keyword">auto</span>;</span><br><span class="line">...</span><br><span class="line"><span class="comment">/*样式部分省略*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*弹窗样式*/</span></span><br><span class="line">.open-box &#123;</span><br><span class="line">position: fixed;</span><br><span class="line">background: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.4</span>);</span><br><span class="line">width: <span class="number">100</span>%;</span><br><span class="line">height: <span class="number">100</span>%;</span><br><span class="line">left: <span class="number">0</span>;</span><br><span class="line">top: <span class="number">0</span>;</span><br><span class="line">z-index: <span class="number">100</span>;</span><br><span class="line">color: <span class="meta">#fff;</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">/*样式部分省略*/</span></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p><p>TP5中相应的代码做数据库处理<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 获取列表数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> function <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $res = model('Member')-&gt;getUserList();</span><br><span class="line">    <span class="keyword">return</span> $res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 新增列表数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> function <span class="title">addList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $nickname=Input('nickname');</span><br><span class="line">    $age=Input('age',0,'floatval');</span><br><span class="line">    $res = model('Member')-&gt;save([</span><br><span class="line">        'nickname'=&gt;$nickname,</span><br><span class="line">        'age'=&gt;$age,</span><br><span class="line">        'status'=&gt;1</span><br><span class="line">    ]);</span><br><span class="line">    <span class="keyword">if</span>($res)&#123;</span><br><span class="line">        $data=['nickname'=&gt;$nickname,'age'=&gt;$age];</span><br><span class="line">        $data = json_encode($data);</span><br><span class="line">        <span class="keyword">return</span> $data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 删除列表数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> function <span class="title">delList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $nickname=Input('nickname');</span><br><span class="line">    model('Member')-&gt;save(['status'=&gt;-1],['nickname'=&gt;$nickname]);</span><br><span class="line">    return '操作成功';</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 清空还原列表数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> function <span class="title">controlList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    if(!model('Member')-&gt;where(['status'=&gt;1])-&gt;count())&#123;</span><br><span class="line">        model('Member')-&gt;save(['status'=&gt;1],['status'=&gt;-1]);</span><br><span class="line">        $res = model('Member')-&gt;getUserList();</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        model('Member')-&gt;save(['status'=&gt;-1],['status'=&gt;1]);</span><br><span class="line">        return '';</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 获取信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> function <span class="title">getInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $nickname=Input('nickname');</span><br><span class="line">    $info = model('Member')-&gt;where(['nickname'=&gt;$nickname])-&gt;find();</span><br><span class="line">    <span class="keyword">return</span> $info;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 编辑信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> function <span class="title">addInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $info = Input('info');</span><br><span class="line">    $uid = Input('uid');</span><br><span class="line">    $res = model('Member')-&gt;save(['info'=&gt;$info],['uid'=&gt;$uid]);</span><br><span class="line">    <span class="keyword">if</span>($res)&#123;</span><br><span class="line">        return '编辑成功';</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>数据表结构<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">--</span><br><span class="line">-- 表的结构 `list_member`</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">CREATE TABLE IF NOT EXISTS `list_member` (</span><br><span class="line">  `uid` <span class="keyword">int</span>(<span class="number">11</span>) NOT <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `nickname` varchar(<span class="number">10</span>) NOT <span class="literal">NULL</span>,</span><br><span class="line">  `age` <span class="keyword">int</span>(<span class="number">11</span>) NOT <span class="literal">NULL</span>,</span><br><span class="line">  `status` tinyint(<span class="number">4</span>) NOT <span class="literal">NULL</span>,</span><br><span class="line">  `info` varchar(<span class="number">200</span>) NOT <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (`uid`)</span><br><span class="line">) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=<span class="number">1</span> ;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;前段时间，初次使用前端框架Vue和ThinkPHP5.1，于是就简单结合起来，用Vue+axios发送请求，TP5处理接口数据。&lt;br&gt;这里Vue、axios和TP5等等的安装就不多说了，按照官方文档来就ok了。&lt;br&gt;
    
    </summary>
    
    
      <category term="Vue" scheme="http://yoursite.com/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>shadowsocks</title>
    <link href="http://yoursite.com/2018/02/28/shadowsocks/"/>
    <id>http://yoursite.com/2018/02/28/shadowsocks/</id>
    <published>2018-02-27T16:30:31.000Z</published>
    <updated>2018-03-01T16:18:42.136Z</updated>
    
    <content type="html"><![CDATA[<p>VPS服务器超简单搭建shadowsocks 方法<br>vultr服务器购买：<a href="https://www.vultr.com/" target="_blank" rel="noopener">https://www.vultr.com/</a><br>安装Xshell，安装完成后新建会话（Alt+N），协议选择SSH，主机填写之前的IP Address，端口号选择22。<br><a id="more"></a><br>VPS可以先升级<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y update</span><br></pre></td></tr></table></figure></p><p>有些VPS 没有wget<br>这种要先装<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install wget</span><br></pre></td></tr></table></figure></p><p>输入以下命令：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>wget --no-check-certificate https:<span class="comment">//raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</span></span><br><span class="line"><span class="number">2.</span>chmod +x shadowsocks.sh</span><br><span class="line"><span class="number">3.</span>./shadowsocks.sh <span class="number">2</span>&gt;&amp;<span class="number">1</span> | tee shadowsocks.<span class="built_in">log</span></span><br></pre></td></tr></table></figure></p><p>第一行是下载命令，下载东西，第二行是修改权限，第三行是安装命令<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">配置：</span><br><span class="line">密码：（默认是teddysun.com）</span><br><span class="line">端口：默认是<span class="number">8989</span></span><br><span class="line">然后按任意键安装，退出按 Ctrl+c</span><br></pre></td></tr></table></figure></p><p>安装完成会有一个配置<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Congratulations, shadowsocks install completed!Your Server IP:  ***** VPS的IP地址Your Server Port:  *****  你刚才设置的端口Your Password:  ****  你刚才设置的密码Your Local IP:  <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> Your Local Port:  <span class="number">1080</span> Your Encryption Method:  aes<span class="number">-256</span>-cfb Welcome to visit:https:<span class="comment">//teddysun.com/342.htmlEnjoy it!</span></span><br></pre></td></tr></table></figure></p><p>然后就可以用这些东西</p><p>VPS主机一键安装Google TCP BBR加速<br>因为VPS架构系统的不同，我们很多软件的安装、部署也是具有局限性的。比如搬瓦工以前都是OpenVZ架构，是不可以安装类似锐速、Google TCP BBR来给服务器加速的。在上周的时候，我们都有看到新增KVM架构方案，虽然还处于测试就阶段，但是也是可以购买的，数据中心在洛杉矶QN，最为主要的是KVM架构，我们可以安装Google TCP BBR工具。</p><p>在这篇文章中，将利用teddysun分享的一键Google TCP BBR安装工具脚本（<a href="https://teddysun.com/489.html）来部署到搬瓦工KVM" target="_blank" rel="noopener">https://teddysun.com/489.html）来部署到搬瓦工KVM</a> VPS中，看看速度是否提高。这样我们用来建站或者其他用途的速度应该还是可以提升的。</p><p>第一、系统支持<br>我们系统需要是CentOS 6+，Debian 7+，Ubuntu 12+，除了OpenVZ架构之外都支持，比如常规的KVM和XEN。</p><p>第二、一键脚本安装<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https:<span class="comment">//github.com/teddysun/across/raw/master/bbr.sh</span></span><br><span class="line">chmod +x bbr.sh</span><br><span class="line">./bbr.sh</span><br></pre></td></tr></table></figure></p><p>自动安装，然后最后提示我们需要重启生效。</p><p>第三、检查BBR启动<br>1、检查核心<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -r</span><br></pre></td></tr></table></figure></p><p>检查内核是不是4.10，检测后看到的是”4.10.5-1.el6.elrepo.x86_64”。</p><p>2、执行后返回<br>“net.ipv4.tcp_available_congestion_control = bbr cubic reno”<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl net.ipv4.tcp_available_congestion_control</span><br></pre></td></tr></table></figure></p><p>3、执行后返回<br>“net.ipv4.tcp_congestion_control = bbr”<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl net.ipv4.tcp_congestion_control</span><br></pre></td></tr></table></figure></p><p>4、查看返回值”net.core.default_qdisc = fq”<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl net.core.default_qdisc</span><br></pre></td></tr></table></figure></p><p>5、看到有BBR信息。说明安装成功了。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod | grep bbr</span><br></pre></td></tr></table></figure></p><p>这样，在安装完毕BBR之后，我们去建站等用途的时候，应该是速度有提高的。</p><h3 id="shadowsocks下载"><a href="#shadowsocks下载" class="headerlink" title="shadowsocks下载"></a>shadowsocks下载</h3><h4 id="Android-Google-Play"><a href="#Android-Google-Play" class="headerlink" title="Android  Google Play:"></a>Android  Google Play:</h4><p><a href="http://ossfiles.fyvps.com/ssclient/shadowsocks-nightly-4.2.5.apk" target="_blank" rel="noopener">http://ossfiles.fyvps.com/ssclient/shadowsocks-nightly-4.2.5.apk</a></p><h4 id="iOS-App-Store"><a href="#iOS-App-Store" class="headerlink" title="iOS  App Store:"></a>iOS  App Store:</h4><p>Shadowrocket   黑洞  Detour   Shadowing    Shadowing    Shadowfish (复制任意一个到应用商店尝试搜索下载)</p><h4 id="Mac-OS-X-系统："><a href="#Mac-OS-X-系统：" class="headerlink" title="Mac OS X 系统："></a>Mac OS X 系统：</h4><p><a href="http://ossfiles.fyvps.com/ssclient/ShadowsocksX-NG-1.4.zip" target="_blank" rel="noopener">http://ossfiles.fyvps.com/ssclient/ShadowsocksX-NG-1.4.zip</a></p><h4 id="For-Windows"><a href="#For-Windows" class="headerlink" title="For Windows:"></a>For Windows:</h4><p><a href="http://ossfiles.fyvps.com/ssclient/Shadowsocks-4.0.6.zip" target="_blank" rel="noopener">http://ossfiles.fyvps.com/ssclient/Shadowsocks-4.0.6.zip</a></p><h4 id="Linux-客户端-shadowsocks-qt5-版本"><a href="#Linux-客户端-shadowsocks-qt5-版本" class="headerlink" title="Linux 客户端 ,shadowsocks-qt5 版本:"></a>Linux 客户端 ,shadowsocks-qt5 版本:</h4><p><a href="https://github.com/shadowsocks/shadowsocks-qt5/wiki" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks-qt5/wiki</a></p><h3 id="备用方式"><a href="#备用方式" class="headerlink" title="备用方式"></a>备用方式</h3><h4 id="脚本功能"><a href="#脚本功能" class="headerlink" title="脚本功能"></a>脚本功能</h4><p> 自定义端口号和密码</p><p> 全过程静默安装，不会打扰用户，你所要做的就是去听一首音乐或者去喝杯咖啡</p><p> 一次只允许运行一个shadowsocks进程，脚本会自动检测原来已经运行的进程并杀死</p><p> 安装防火墙并开放需要的端口</p><h4 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h4><p>下载脚本<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O ss.sh http:<span class="comment">//45.32.195.77/file/ss.sh</span></span><br></pre></td></tr></table></figure></p><p>执行脚本<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash ss.sh</span><br></pre></td></tr></table></figure></p><p>设置端口号并回车，直接回车是设置为1225<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Please enter PORT(1225 default):</span><br></pre></td></tr></table></figure></p><p>设置密码并回车，直接回车是设置为123456<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Please enter PASSWORD(123456 default):</span><br></pre></td></tr></table></figure></p><p>等待一会……就完成了（初次执行约2-5min）</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;VPS服务器超简单搭建shadowsocks 方法&lt;br&gt;vultr服务器购买：&lt;a href=&quot;https://www.vultr.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vultr.com/&lt;/a&gt;&lt;br&gt;安装Xshell，安装完成后新建会话（Alt+N），协议选择SSH，主机填写之前的IP Address，端口号选择22。&lt;br&gt;
    
    </summary>
    
    
      <category term="shadowsocks" scheme="http://yoursite.com/tags/shadowsocks/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7</title>
    <link href="http://yoursite.com/2018/02/27/centos/"/>
    <id>http://yoursite.com/2018/02/27/centos/</id>
    <published>2018-02-27T14:28:52.000Z</published>
    <updated>2018-03-01T16:18:42.136Z</updated>
    
    <content type="html"><![CDATA[<p>CentOS 7 安装配置LAMP服务器方法(Apache+PHP+MariaDB)<br>摘要: CentOS 7 安装配置LAMP服务器方法(Apache+PHP+MariaDB)，CentOS 7后Mysql改为MariaDB<br><a id="more"></a><br>准备篇：</p><p>一、配置防火墙，开启80端口、3306端口</p><p>CentOS 7 默认使用的是firewall作为防火墙，这里改为iptables防火墙。</p><p>1、关闭firewall：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service #停止firewall </span><br><span class="line">systemctl disable firewalld.service #禁止firewall开机启动</span><br></pre></td></tr></table></figure></p><p>2、安装iptables防火墙</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install iptables-services #安装 </span><br><span class="line">vi /etc/sysconfig/iptables #编辑防火墙配置文件</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># Firewall configuration written by system-config-firewall </span><br><span class="line"># Manual customization of <span class="keyword">this</span> file is <span class="keyword">not</span> recommended. </span><br><span class="line">*filter </span><br><span class="line">:INPUT ACCEPT [<span class="number">0</span>:<span class="number">0</span>] </span><br><span class="line">:FORWARD ACCEPT [<span class="number">0</span>:<span class="number">0</span>] </span><br><span class="line">:OUTPUT ACCEPT [<span class="number">0</span>:<span class="number">0</span>] </span><br><span class="line">-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT </span><br><span class="line">-A INPUT -p icmp -j ACCEPT </span><br><span class="line">-A INPUT -i lo -j ACCEPT </span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport <span class="number">22</span> -j ACCEPT </span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport <span class="number">80</span> -j ACCEPT </span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport <span class="number">3306</span> -j ACCEPT </span><br><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited </span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited </span><br><span class="line">COMMIT </span><br><span class="line">:wq! #保存退出</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart iptables.service #最后重启防火墙使配置生效 </span><br><span class="line">systemctl enable iptables.service #设置防火墙开机启动</span><br></pre></td></tr></table></figure><p>二、关闭SELINUX<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/selinux/config</span><br><span class="line">#SELINUX=enforcing #注释掉</span><br><span class="line">#SELINUXTYPE=targeted #注释掉</span><br><span class="line">SELINUX=disabled #增加</span><br><span class="line">:wq! #保存退出</span><br><span class="line">setenforce <span class="number">0</span> #使配置立即生效</span><br></pre></td></tr></table></figure></p><p>安装篇：</p><p>一、安装Apache<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install httpd #根据提示，输入Y安装即可成功安装</span><br><span class="line">systemctl start httpd.service #启动apache</span><br><span class="line">systemctl stop httpd.service #停止apache</span><br><span class="line">systemctl restart httpd.service #重启apache</span><br><span class="line">systemctl enable httpd.service #设置apache开机启动</span><br></pre></td></tr></table></figure></p><p>二、安装MariaDB</p><p>CentOS 7 中，已经使用MariaDB替代了MySQL数据库</p><p>1、安装MariaDB<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install mariadb mariadb-server #询问是否要安装，输入Y即可自动安装,直到安装完成</span><br><span class="line">systemctl start mariadb.service #启动MariaDB</span><br><span class="line">systemctl stop mariadb.service #停止MariaDB</span><br><span class="line">systemctl restart mariadb.service #重启MariaDB</span><br><span class="line">systemctl enable mariadb.service #设置开机启动</span><br><span class="line">cp /usr/share/mysql/my-huge.cnf /etc/my.cnf #拷贝配置文件（注意：如果/etc目录下面默认有一个my.cnf，直接覆盖即可）</span><br></pre></td></tr></table></figure></p><p>2、为root账户设置密码<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_secure_installation</span><br></pre></td></tr></table></figure></p><p>回车，根据提示输入Y</p><p>输入2次密码，回车</p><p>根据提示一路输入Y</p><p>最后出现：Thanks for using MySQL!</p><p>MySql密码设置完成，重新启动 MySQL：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mariadb.service #重启MariaDB</span><br></pre></td></tr></table></figure></p><p>三、安装PHP</p><p>1、安装PHP 和 php-devel工具 方便日后使用 phpize 做扩展编译<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install php php-devel #根据提示输入Y直到安装完成</span><br></pre></td></tr></table></figure></p><p>2、安装PHP组件，使PHP支持 MariaDB<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install php-mysql php-gd libjpeg* php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-bcmath php-mhash</span><br></pre></td></tr></table></figure></p><p>这里选择以上安装包进行安装，根据提示输入Y回车<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mariadb.service #重启MariaDB</span><br><span class="line"></span><br><span class="line">systemctl restart httpd.service #重启apache</span><br></pre></td></tr></table></figure></p><p>注意：apache默认的程序目录是/var/www/html</p><p>权限设置：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R apache:apache  /var/www/html</span><br></pre></td></tr></table></figure></p><p>至此，CentOS 7.0安装配置LAMP服务器(Apache+PHP+MariaDB)教程完成！<br>原文链接：<a href="https://my.oschina.net/sallency/blog/467647" target="_blank" rel="noopener">https://my.oschina.net/sallency/blog/467647</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CentOS 7 安装配置LAMP服务器方法(Apache+PHP+MariaDB)&lt;br&gt;摘要: CentOS 7 安装配置LAMP服务器方法(Apache+PHP+MariaDB)，CentOS 7后Mysql改为MariaDB&lt;br&gt;
    
    </summary>
    
    
      <category term="CentOS" scheme="http://yoursite.com/tags/CentOS/"/>
    
  </entry>
  
</feed>
